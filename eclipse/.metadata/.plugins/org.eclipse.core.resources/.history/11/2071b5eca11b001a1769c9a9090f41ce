package net.minecraft.util;

import java.io.IOException;
import java.net.ConnectException;
import java.net.URL;

import org.apache.commons.io.IOUtils;
import org.json.simple.JSONObject;
import org.json.simple.JSONValue;
import org.json.simple.parser.ParseException;

public class ThreadSkinGetter extends Thread{
	private String currentName;	
	private String UUIDResult;
	public boolean needsUpdate;
	 public  ThreadSkinGetter(String name) 
	 {
		 currentName = name;
		 
	       
	  }
	 
	 public void run()
	 {
		 String url = "https://api.mojang.com/users/profiles/minecraft/"+currentName;
	        try {
	        	System.out.println((new StringBuilder()).append("SENDING REQUEST TO: ").append(url).toString());
	            String UUIDJson = IOUtils.toString(new URL(url));           
	            if(UUIDJson.isEmpty())
	            {
	            UUIDResult = "invalid name";
	            }
	            
	            
	            JSONObject UUIDObject = (JSONObject) JSONValue.parseWithException(UUIDJson);
	            System.out.println(UUIDObject.get("id").toString());
	            UUIDResult = UUIDObject.get("id").toString();
	            needsUpdate = true;
	            
	        } catch (IOException | ParseException e) {
	            e.printStackTrace();
	            UUIDResult = "error";
	        }
	       
	      
	 }
	 public boolean getNeedsUpdate()
	 {
		 return this.needsUpdate;
	 }
	
	 public void setNeedsUpdate(boolean flag)
	 {
		 this.needsUpdate = flag;
	 }
	 public String getUUIDResult()
	 {
		 return this.UUIDResult;
	 }
}
